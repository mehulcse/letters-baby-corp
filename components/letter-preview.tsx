"use client";

import { useRef } from "react";
import Image from "next/image";
import { Button } from "@/components/ui/button";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import html2canvas from "html2canvas";
import jsPDF from "jspdf";
import { ReactNode } from "react";
import { cn } from "@/lib/utils";

interface LetterPreviewProps {
  isOpen: boolean;
  onClose: () => void;
  letterType: "TUTU" | "GENERIC" | "ADDRESS";
  data: any;
}

const LogoHeader = () => (
  <div className="w-full">
    <div className="flex justify-center mb-6">
      <div className="relative w-[120px] h-[120px]">
        <Image 
          src="/baby-corp-logo.png" 
          alt="Baby Corp Logo" 
          fill
          priority
          sizes="120px"
          className="object-contain"
          style={{ transform: 'scale(1.2)' }}
        />
      </div>
    </div>
    <div className="w-full border-b-2 border-black mb-8" />
  </div>
);

const Footer = () => (
  <footer className="text-xs mt-8 text-gray-600 border-t pt-4 text-center">
    <p className="text-center">Com. Add: B-602, Kadamb Greens, Zundal, Gandhi Nagar, Ahmedabad, Gujarat, India</p>
    <p className="text-center">+91 977-301-3115 / +91-972-244-1030 keshivsbabycorp@gmail.com</p>
  </footer>
);

export function LetterPreview({ isOpen, onClose, letterType, data }: LetterPreviewProps): ReactNode {
  const letterRef = useRef<HTMLDivElement>(null);

  const handlePrint = () => {
    window.print();
  };

  const handleDownloadPDF = async () => {
    if (!letterRef.current) return;

    try {
      // Wait for images to load
      await new Promise((resolve) => setTimeout(resolve, 1000));

      const canvas = await html2canvas(letterRef.current, {
        scale: 3,
        useCORS: true,
        logging: false,
        allowTaint: true,
        imageTimeout: 5000,
        onclone: (document) => {
          // Ensure images are loaded
          const images = document.getElementsByTagName('img');
          return Promise.all(Array.from(images).map((img) => {
            if (img.complete) return Promise.resolve();
            return new Promise((resolve) => {
              img.onload = resolve;
              img.onerror = resolve;
            });
          }));
        },
      });

      const imgData = canvas.toDataURL('image/png', 1.0);
      const pdf = new jsPDF({
        orientation: letterType === 'ADDRESS' ? 'landscape' : 'portrait',
        unit: 'mm',
        format: 'a4',
        compress: false,
      });

      const pdfWidth = pdf.internal.pageSize.getWidth();
      const pdfHeight = pdf.internal.pageSize.getHeight();
      
      pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight, '', 'FAST');
      pdf.save(`${letterType.toLowerCase()}-letter.pdf`);
    } catch (error) {
      console.error('Error generating PDF:', error);
    }
  };

  const renderLetter = () => {
    switch (letterType) {
      case "TUTU":
        return renderTUTULetter();
      case "GENERIC":
        return renderGenericLetter();
      case "ADDRESS":
        return renderAddressLetter();
      default:
        return null;
    }
  };

  const renderTUTULetter = () => (
    <div className="space-y-4 bg-white font-[family-name:var(--font-geist-sans)]">
      {/* Page 1: English Content */}
      <div className="p-8 min-h-[297mm] flex flex-col print-page">
        <LogoHeader />
        
        <div className="flex-grow space-y-4">
          <p className="mb-4">Dear {data.englishName},</p>
          <p>We're thrilled to accompany you on this journey as you introduce our Automatic Cradle Kit into your home. Our cradle combines safety and durability with a shock-proof design, a safe adapter, and sturdy stainless steel hooks to ensure a secure environment for your cherished ones. Built to last, its reliable motor provides lasting, gentle movements.</p>
          
          <p>Imagine the cradle softly swaying, infusing your home with peaceful moments and joyful smiles. We hope it enhances your daily life, bringing not just rest but deep satisfaction, knowing that your family experiences the best in comfort and safety.</p>
          
          <p className="font-semibold">Love What You Bought? ЁЯМЯ</p>
          
          <p>If you're delighted with our product, we'd truly appreciate a <span className="font-semibold">5-star rating!</span> Your positive feedback helps other customers choose Baby Corp with confidence.</p>
          
          <p>Want to make a greater impact? Share a <span className="font-semibold">photo or video review</span> to show others the quality firsthand.</p>
          
          <p className="font-semibold">Exclusive Offer ЁЯОБ</p>
          
          <p>As a thank-you, send us a <span className="font-semibold">screenshot of your photo/video review</span> along with your invoice on WhatsApp at <span className="font-semibold">9722441030</span>, and we'll send you <span className="font-semibold">Rs. 50</span> as a token of our appreciation!</p>
          
          <p>Thank you for your support, and we hope to see you again soon!</p>
          
          <p>Warm regards,<br />
          Baby Corp<sup>TM</sup><br />
          +91-972-244-1030<br />
          +91 977-301-3115</p>
        </div>
        <Footer />
      </div>

      {/* Page 2: Local Language Content */}
      <div className="p-8 min-h-[297mm] flex flex-col print-page">
        <LogoHeader />
        
        <div className="flex-grow space-y-4">
          {data.language === "hindi" && (
            <>
              <p>{data.localName},</p>
              <p>рдмреЗрдмреА рдХреЙрд░реНрдк рдкрд░рд┐рд╡рд╛рд░ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ! рд╣рдорд╛рд░реА рдСрдЯреЛрдореИрдЯрд┐рдХ рдХреНрд░реИрдбрд▓ рдХрд┐рдЯ рдЖрдкрдХреЗ рдШрд░ рдореЗрдВ рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо рдмрд╣реБрдд рдЙрддреНрд╕рд╣рд┐рдд рд╣реИрдВред рдЗрд╕ рдХреНрд░реИрдбрд▓ рдХреЗ рдбрд┐рдЬрд╛рдЗрди рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЯрд┐рдХрд╛рдКрдкрди рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИтАФрдЗрд╕рдореЗрдВ рд╢реЙрдХ-рдкреНрд░реВрдл рдбрд┐рдЬрд╛рдЗрди, рд╕реБрд░рдХреНрд╖рд┐рдд рдПрдбреЗрдкреНрдЯрд░, рдФрд░ рдордЬрдмреВрдд рд╕реНрдЯреЗрдирд▓реЗрд╕ рд╕реНрдЯреАрд▓ рд╣реБрдХ рд╣реИ, рддрд╛рдХрд┐ рдЖрдкрдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдорд┐рд▓реЗред рдЯрд┐рдХрд╛рдК рдореЛрдЯрд░ рдЗрд╕реЗ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдмрдирд╛рдП рд░рдЦреЗрдЧреАред</p>
              
              <p>рдЖрд╢рд╛ рд╣реИ рдХрд┐ рдЭреВрд▓реЗ рдХрд╛ рдзреАрдорд╛ рд╣рд┐рд▓рдирд╛-рдбреБрд▓рдирд╛ рдЖрдкрдХреЗ рдШрд░ рдореЗрдВ рд╢рд╛рдВрддрд┐ рдФрд░ рдЖрдирдВрдж рд▓рд╛рдПя┐╜я┐╜я┐╜ред рдпрд╣ рдирдпрд╛ рдЬреЛрдбрд╝ рдЖрдкрдХреЗ рджреИрдирд┐рдХ рдЬреАрд╡рди рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдЖрд░рд╛рдорджрд╛рдпрдХ рдФрд░ рд╕реБрдЦрдж рдмрдирд╛рдПрдЧрд╛, рдФрд░ рдЖрдкрдХреЛ рдпрдХреАрди рджрд┐рд▓рд╛рдПрдЧрд╛ рдХрд┐ рдЖрдкрдХреЗ рдкрд░рд┐рд╡рд╛рд░ рдХреЛ рд╕рд░реНрд╡реЛрддреНрддрдо рд╕реБрд╡рд┐рдзрд╛ рдорд┐рд▓ рд░рд╣реА рд╣реИред</p>
              
              <p>рдХреНрдпрд╛ рдЖрдкрдХреЛ рд╣рдорд╛рд░рд╛ рдЙрддреНрдкрд╛рдж рдкрд╕рдВрдж рдЖрдпрд╛? рдЬрдм рдЖрдк рдирдП рдХреНрд░реИрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рддреЛ рдЖрдкрдХреЗ рдЕрдиреБрднрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд░ рд╣рдореЗрдВ рдЦреБрд╢реА рд╣реЛрдЧреАред рдЕрдЧрд░ рдЖрдкрдХреЛ рдереЛрдбрд╝рд╛ рд╕рдордп рдорд┐рд▓реЗ, рддреЛ рдХреГрдкрдпрд╛ рдЕрдкрдиреЗ рд╡рд┐рдЪрд╛рд░ рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред рдЖрдкрдХреА рд╕рдореАрдХреНрд╖рд╛ рд╣рдореЗрдВ рдЗрд╕ рдЙрддреНрдкрд╛рдж рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдФрд░ рдЕрдиреНрдп рдЦрд░реАрджрд╛рд░реЛрдВ рдХреА рдорджрдж рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░реЗрдЧреАред рдпрджрд┐ рдЖрдк рд╣рдорд╛рд░реЗ рдЙрддреНрдкрд╛рдж рд╕реЗ рдкреНрд░рд╕рдиреНрди рд╣реИрдВ, рддреЛ рдЕрдореЗрдЬрд╝рди рдкрд░ 5-рд╕реНрдЯрд╛рд░ рд░реЗрдЯрд┐рдВрдЧ рджреЗрдХрд░ рд╣рдореЗрдВ рдЦреБрд╢реА рд╣реЛрдЧреА! рдЖрдкрдХреА рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдиреНя┐╜я┐╜я┐╜ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдмреЗрдмреА рдХреЙрд░реНрдк рдкрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗ рд╕рд╛рде рдирд┐рд░реНрдгрдп рд▓реЗрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред</p>
              
              <p>рдмрдбрд╝рд╛ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдЧреБрдгрд╡рддреНрддрд╛ рдХрд╛ рдЕрдиреБрднрд╡ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЛрдЯреЛ рдпрд╛ рд╡реАрдбрд┐рдпреЛ рд░рд┐рд╡реНрдпреВ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред</p>
              
              <p>рд╡рд┐рд╢реЗрд╖ рдлрд░ ЁЯОБ рдЖрдкрдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж рд╕реНрд╡рд░реВрдк, рдЕрдкрдиреА 5-рд╕реНрдЯрд╛рд░ рдлреЛрдЯреЛ/рд╡реАрдбрд┐рдпреЛ рд░рд┐рд╡реНрдпреВ рдХрд╛ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдФрд░ рдЗрдирд╡реЙрдЗрд╕ рд╣рдореЗрдВ рд╡реНрд╣рд╛рдЯреНрд╕рдПрдк рдкрд░ 9722441030 рдкрд░ рднреЗрдЬреЗрдВ, рдФрд░ рд╣рдо рдЖрдкрдХреЛ рдЖрднрд╛рд░ рд╕реНрд╡рд░реВрдк тВ╣50 рднреЗрдЬреЗрдВрдЧреЗ!</p>
              
              <p>рдЖрдкрдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж!</p>
              
              <p>рдзрдиреНрдпрд╡рд╛рдж,<br />
              рдмреЗрдмреА рдХреЙрд░реНрдктДв<br />
              +репрез репренрен-рейрежрез-рейрезрезрел<br />
              +репрез репренреи-реирекрек-резрежрейреж</p>
            </>
          )}
          {data.language === "gujarati" && (
            <>
              <p>{data.localName},</p>
              <p>ркмрлЗркмрлА ркХрлЛрк░рлНркк рккрк░рк┐рк╡рк╛рк░ркорк╛ркВ ркдркорк╛рк░рлБркВ рк╕рлНрк╡рк╛ркЧркд ркЫрлЗ! ркдркорк╛рк░рлБркВ ркирк╡рлБркВ рк╡рк░рлНрк╖ ркЦрлБрк╢рлА ркЕркирлЗ рк╕ркорлГркжрлНркзрк┐ркерлА ркнрк░рлЗрк▓рлБркВ рк░рк╣рлЗ ркдрлЗрк╡рлА рк╢рлБркнрлЗркЪрлНркЫрк╛ркУ. ркЕркорк╛рк░рлА ркСркЯрлЛркорлЗркЯрк┐ркХ ркХрлНрк░рлЗркбрк▓ ркХрк┐ркЯ ркдркорк╛рк░рк╛ ркШрк░ркорк╛ркВ рк▓ркИркирлЗ ркЖрк╡рк╡рк╛ ркорк╛ркЯрлЗ ркЕркорлЗ ркЦрлВркм ркЬ ркЙркдрлНрк╕рк╛рк╣рлА ркЫрлАркП. ркЖ ркХрлНрк░рлЗркбрк▓ркирк╛ ркбрк┐ркЭрк╛ркЗркиркоркВ рк╕рк▓рк╛ркдрлА ркЕркирлЗ ркЯркХрк╛ркЙрккркгрк╛ркирлЗ ркзрлНркпрк╛ркиркорк╛ркВ рк░рк╛ркЦрк╡рк╛ркорк╛ркВ ркЖрк╡рлНркпрлБркВ ркЫрлЗтАФркЖркорк╛ркВ shock-proof ркбрк┐ркЭрк╛ркЗрки, рк╕рк▓рк╛ркоркд ркПркбрлЗрккрлНркЯрк░, ркЕркирлЗ ркоркЬркмрлВркд рк╕рлНркЯрлЗркирк▓рлЗрк╕ рк╕рлНркЯрлАрк▓ рк╣рлВркХ ркЫрлЗ, ркЬрлЗркерлА ркдркорк╛рк░рк╛ ркмрк╛рк│ркХрлЛркирлЗ рк╕рлБрк░ркХрлНрк╖рк┐ркд рк╡рк╛ркдрк╡рк░ркг ркорк│рлЗ. ркЯркХрк╛рк╡ркЯ рк╡рк╛ркдрлА ркорлЛркЯрк░ рк▓рк╛ркВркмрк╛ рк╕ркоркп рк╕рлБркзрлА ркЖркирлЗ ркЯркХрк╛рк╡рлА рк░рк╛ркЦрк╢рлЗ.</p>
              
              <p>ркЖрк╢рк╛ ркЫрлЗ ркХрлЗ ркШрлЛркбрк┐ркпрк╛ ркирлБркВ ркзрлАркорлБркВ ркзрлАркорлБркВ рк╣рк▓ркиркЪрк▓рки, ркдркорк╛рк░рк╛ ркШрк░ркорк╛ркВ рк╢рк╛ркВркдрк┐ ркЕркирлЗ ркЖркиркВркж рк▓рк╛рк╡рк╢рлЗ. ркЖ ркирк╡рлБркВ ркЙркорлЗрк░ркг ркдркорк╛рк░рк╛ ркжрлИркирк┐ркХ ркЬрлАрк╡ркиркирлЗ рк╡ркзрлБ ркЖрк░рк╛ркоркжрк╛ркпркХ ркЕркирлЗ рк╕рлБркЦркж ркмркирк╛рк╡рк╢рлЗ, ркЕркирлЗ ркдркоркирлЗ ркЦрк╛ркдрк░рлА ркорк│рк╢рлЗ ркХрлЗ ркдркорк╛рк░рк╛ рккрк░рк┐рк╡рк╛рк░ркирлЗ рк╢рлНрк░рлЗрк╖рлНрка рк╕ркЧрк╡ркб ркорк│рлА ркЫрлЗ.</p>
              
              <p>ркЕркорк╛рк░рк╛ рккрлНрк░рлЛркбркХрлНркЯркерлА ркЦрлБрк╢ ркЫрлЛ? ркдркорк╛рк░рлЛ ркЕркирлБркнрк╡ рк╢рлЗрк░ ркХрк░рлЛ ЁЯУ╣</p>
              
              <p>ркЬрлЛ ркЖ рккрлНрк░рлЛркбркХрлНркЯркерлА ркдркорлЗ ркЦрлБрк╢ ркЫрлЛ ркдрлЛ ркорк╛рк░рк╛ ркЕркирлБрк╡ ркЕркВркЧрлЗ ркЬрк╛ркгрлАркирлЗ ркЕркоркирлЗ ркЖя┐╜я┐╜ркж ркерк╢рлЗ. ркЬрлЛ ркдркоркирлЗ ркерлЛркбрлАрк╡рк╛рк░ ркорк│рлЗ, ркдрлЛ ркХрлГрккрк╛ ркХрк░рлАркирлЗ ркдркорк╛рк░рк╛ ркЕркнрк┐рккрлНрк░рк╛ркп рк╕рк╛ркерлЗ ркЕркоркирлЗ 5-star ркорлВрк▓рлНркпрк╛ркВркХрки ркЖрккрлЛ. ркдркорк╛рк░рлЛ рк░рк┐рк╡рлНркпрлВ ркЕркоркирлЗ ркЖ рккрлНрк░рлЛркбркХрлНркЯ рк╕рлБркзрк╛рк░рк╡рк╛ркорк╛ркВ ркЕркирлЗркп ркЦрк░рлАркжркжрк╛рк░рлЛркирлЗ ркжркжрк░рлВркк ркерк╢рлЗ.</p>
              
              <p>рк╡рк┐рк╢рк┐рк╖рлНркЯ ркСрклрк░ ЁЯОБ</p>
              
              <p>ркдркорлЗ рклрлЛркЯрлЛ ркЕркерк╡рк╛ рк╡рк┐ркбрк┐ркпрлЛ рк░рк┐рк╡рлНркпрлБркирлЛ рк╕рлНркХрлНрк░рлАркирк╢рлЛркЯ ркЕркирлЗ ркдркорк╛рк░рлА ркИркирлНрк╡рлЙркЗрк╕ 9722441030 рккрк░ рк╡рлЛркЯрлНрк╕ркПрккрлН ркХрк░рлЛ, ркЕркирлЗ ркЕркорлЗ ркдркорк╛рк░рк╛ ркЖркнрк╛рк░ркирлА ркирк┐рк╢рк╛ркирлА ркдрк░рлАркХрлЗ ркдркоркирлЗ рк░рлВ. 50 ркорлЛркХрк▓рлАрк╢рлБркВ!</p>
              
              <p>ркдркорк╛рк░рк╛ рк╕рккрлЛрк░рлНркЯ ркорк╛ркЯрлЗ ркЖркнрк╛рк░!</p>
              
              <p>ркЖркнрк╛рк░,<br />
              ркмрлЗркмрлА ркХрлЛрк░рлНркктДв<br />
              +рлпрлз-рлпрлнрли-рлирлкрлк-рлзрлжрлйрлж<br />
              +рлпрлз рлпрлнрлн-рлйрлжрлз-рлйрлзрлзрлл</p>
            </>
          )}
          {data.language === "marathi" && (
            <>
              <p>{data.localName},</p>
              <p>рдмреЗрдмреА рдХреЙрд░реНрдк реБрдЯреБрдВрдмрд╛рдд рддреБрдордЪрдВ рд╕реНрд╡рд╛рдЧрдд рдЖрд╣реЗ!</p>
              <p>рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдЖрдордЪреНрдпрд╛ рдСрдЯреЛрдореЕрдЯрд┐рдХ рдХреНрд░реЕрдбрд▓ рдХрд┐рдЯрд▓рд╛ рдЖрдкрд▓реНрдпрд╛ рдШрд░рд╛рдд рдЖрдгрдгреНрдпрд╛рдЪреНрдпрд╛ рдпрд╛ рдкреНрд░рд╡рд╛рд╕рд╛рдд рдЖрдкрд▓рд╛ рд╕рд╛рдереАрджрд╛рд░ рдмреВрди рдЖрдореНрд╣рд╛рд▓рд╛ рддреНрдпрдВрдд рдЖрдирдВрдж рд╣реЛрддреЛ рдЖрд╣реЗ. рдЖрдордЪреЗ рдХреНрд░реЕрдбрд▓ рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рдЖрдгрд┐ рдЯрд┐рдХрд╛рдКрдкрдгрд╛рдЪрд╛ рд╕рдВрдЧрдо рдЖрд╣реЗ, рд╢реЙрдХ-рдкреНрд░реВрдл рдбрд┐рдЭрд╛рдЗрди, рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрдбреЕрдкреНрдЯрд░ рдЖрдгрд┐ рдордЬрдмреВрдд рд╕реНрдЯреЗрдирд▓реЗрд╕ рд╕реНрдЯреАрд▓ рд╣реБрдХреНрд╕рд╕рд╣, рдЬреНрдпрд╛рдореБрд│реЗ рдЖрдкрд▓реНрдпрд╛ рдкреНрд░рд┐рдпрдЬрдирд╛рдВрд╕рд╛рдареА рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддреЗ. рджреАрд░реНрдШрдХрд╛рд│ рдЯрд┐рдХрдгреНрдпрд╛рд╕рд╛рдареА рдмрдирд╡рд▓реЗрд▓реЗ, рддреНрдпрд╛рдЪреЗ рд╡рд┐рд╢реНрд╡рд╛рд╕рд╛рд░реНрд╣ рдореЛрдЯрд░ рд╣рд▓рдХреНрдпрд╛ рдЖрдгрд┐ рд╕реМрдореНрдп рд╣рд╛рд▓рдЪрд╛рд▓реАрдВрдиреА рдЪрд╛рд▓рддреЗ.</p>

              <p>рдХрд▓реНрдкрдирд╛ рдХрд░рд╛ рдХреА рдХреНрд░реЕрдбрд▓ рд╕реМрдореНрдпрдкрдгреЗ рд╣рд▓рдд рдЖрд╣реЗ, рдЖрдкрд▓реНрдпрд╛ рдШрд░рд╛рдд рд╢рд╛рдВрддреЗрдЪреНрдпрд╛ рдХреНрд╖рдгрд╛рдВрдиреА рдЖрдгрд┐ рдЖрдирдВрджрджрдпреА рд╣рд╕рдгреНрдпрд╛рдиреЗ рднрд░рд▓реЗ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЖрд╢рд╛ рдХрд░рддреЛ рдХреА рд╣реЗ рдЖрдкрд▓реНрдпрд╛ рджреИрдирдВрджрд┐рди рдЬреАрд╡рдирд╛рд▓рд╛ рд╕реБрдзрд╛рд░реЗрд▓, рдХреЗрд╡рд│ рд╡рд┐рд╢реНрд░рд╛рдВрддреАрдЪ рдирд╛рд╣реА рддрд░ рдЦреЛрд▓ рд╕рдорд╛рдзрд╛рди рдЖрдгреЗрд▓, рдХрд╛рд░рдг рдЖрдкрд▓реА рдХреБрдЯреБрдВрдмреЗ рдЖрд░рд╛рдо рдЖрдгрд┐ рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрдиреБрднрд╡рддрд╛рдд.</p>

              <p>рдЖрдкрдг рдЬреЗ рдЦрд░реЗрджреА рдХреЗрд▓реЗ рддреНрдпрд╛рд╡рд░ рдЦреБрд╢ рдЖрд╣реЗ рдХрд╛? рдЬрд░ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдЖрдордЪреНрдпрд╛ рдЙрддреНрдкрд╛рджрдирд╛рд╡рд░ рдЖрдирдВрдж рдЭрд╛рд▓рд╛ рдЕрд╕реЗрд▓, рддрд░ рдЖрдореНрд╣реА 5-рд╕реНрдЯрд╛рд░ рд░реЗрдЯрд┐рдВрдЧрдЪреА рдЕрддреНрдпрдВрдд рдкреНрд░рд╢рдВрд╕рд╛ рдХрд░реВ! рдЖрдкрд▓реЗ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдЕрднрд┐рдкреНрд░рд╛рдп рдЗрддрд░ рдЧреНрд░рд╛рд╣рдХрд╛рдВрдирд╛ Baby Corp рдирд┐рд╡рдбрдгреНрдпрд╛рд╕ рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕рд╛рдиреЗ рдорджрдд рдХрд░рддрд╛рдд. рдЖрдкрд▓рд╛ рдкреНрд░рднрд╛рд╡ рд╡рд╛рдврд╡реВ рдЗрдЪреНрдЫрд┐рддрд╛? рджреБрд╕рд▒реНрдпрд╛рдВрдирд╛ рдЧреБрдгрд╡рддреНрддрд╛ рдкреНрд░рддреНрдпрдХреНрд╖ рдкрд╛рд╣рдгреНрдпрд╛рд╕рд╛рдареА рдлреЛрдЯреЛ рдХрд┐рдВрд╡рд╛ рд╡реНрд╣рд┐рдбрд┐рдУ рдкреБрдирд░рд╛рд╡рд▓реЛрдХрди рд╢реЗрдЕрд░ рдХрд░рд╛.</p>

              <p>рд╡рд┐рд╢реЗрд╖ рдСрдлрд░ ЁЯОБ рдзрдиреНрдпрд╡рд╛рдж рдореНрдгреВрди, рдЖрдкрд▓рд╛ 5-рд╕реНрдЯрд╛рд░ рдлреЛрдЯреЛ/рд╡реНрд╣рд┐рдбрд┐рдУ рдкреБрдирд░рд╛рд╡рд▓реЛрдХрди рдЖрдгрд┐ рдмрд┐рд▓рдЪрд╛ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ WhatsApp рд╡рд░ 9722441030 рд╡рд░ рдкрд╛рдард╡рд╛ рдЖрдгрд┐ рдЖрдореНрд╣реА рдЖрдкрд▓реНрдпрд╛ рдХреГрддрдЬреНрдЮрддреЗ рдЪрд┐рдиреНрд╣ рдгреВрди Rs. 50 рдкрд╛рдард╡реВ!</p>

              <p>рдЖрдкрд▓реНрдпрд╛ рд╕рдорд░реНрдердирд╛рдмрджреНрджрд▓ рдзрдиреНрдпрд╡рд╛рдж, рдЖрдгрд┐ рдЖрдореНрд╣реА рд▓рд╡рдХрд░рдЪ рдкреБрдиреНрд╣рд╛ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдкрд╛рд╣рдгреНрдпрд╛рдЪреА рдЖрд╢рд╛ рдХрд░рддреЛ!</p>

              <p>рдЖрдкреБрд▓рдХреАрдиреЗ,<br />
              рдмреЗрдмреА рдХреЙрд░реНрдк (Baby Corp<sup>TM</sup>)<br />
              +91-972-244-1030<br />
              +91 977-301-3115</p>
            </>
          )}
        </div>
        <Footer />
      </div>

      {/* Page 3: Gift Message */}
      <div className="p-8 min-h-[297mm] flex flex-col print-page">
        <LogoHeader />
        
        <div className="flex-grow space-y-8">
          {/* English Gift Message */}
          <div className="space-y-4 mb-12">
            <p>Dear {data.englishName},</p>
            <p>Welcome to the Baby Corp family! As you're one of our valued customers, we're thrilled to celebrate this milestone with you. To show our appreciation, we've included a special surprise gift with your Automatic Cradle Kit. We hope it brings you and your little one extra joy!</p>
            <p>Warm regards,<br />
            Baby Corp<sup>TM</sup><br />
            +91-972-244-1030<br />
            +91 977-301-3115</p>
          </div>

          {/* Local Language Gift Message */}
          <div className="space-y-4 pt-8 border-t">
            {data.language === "hindi" && (
              <>
                <p>рдкреНрд░рд┐рдп {data.localName},</p>
                <p>рдмреЗрдмреА рдХреЙрд░реНрдк рдкрд░рд┐рд╡рд╛рд░ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ! рдЖрдк рд╣рдорд╛рд░реЗ рдкреНрд░рд┐рдп рдЧреНрд░рд╛рд╣рдХ рд╣реИрдВ, рдФрд░ рд╣рдо рдЗрд╕ рдорд╛рдЗрд▓рд╕реНрдЯреЛрди рдХреЛ рдЖрдкрдХреЗ рд╕рд╛рде рдордирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЗ рдСрдЯреЛрдореИрдЯрд┐рдХ рдХреНрд░реИрдбрд▓ рдХрд┐рдЯ рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рд░рдкреНрд░рд╛рдЗрдЬрд╝ рдЧрд┐рдлреНрдЯ рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗ рд░реЛрдорд╛рдВрдЪрд┐рдд рд╣реИрдВред рд╣рдореЗрдВ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдпрд╣ рдкрд╕рдВрдж рдЖрдПрдЧрд╛!</p>
                <p>рд╕рд╛рджрд░,<br />
                рдмреЗрдмреА рдХреЙрд░реНрдк (Baby Corp<sup>TM</sup>)<br />
                +91-972-244-1030<br />
                +91 977-301-3115</p>
              </>
            )}
            {data.language === "gujarati" && (
              <>
                <p>{data.localName},</p>
                <p>ркмрлЗркмрлА ркХрлЛрк░рлНркк рккрк░рк┐рк╡рк╛рк░ркорк╛ ркЖрккркирлБркВ ркжрк┐рк▓ркерлА рк╕рлНрк╡рк╛ркЧркд ркЫрлЗ! ркЖркк ркЕркорк╛рк░рк╛ рккрлНрк░рк┐ркп ркЕркирлЗ ркорлВрк▓рлНркпрк╡рк╛рки ркЧрлНрк░рк╛рк╣ркХ ркЫрлЛ, ркЖркк рк╕рк╛ркерлЗ ркЖ ркЦрлБрк╕рлНрк╕ркирлА ркЙркЬрк╡ркгрлА ркХрк░ркдрк╛ ркЕркоркирлЗ ркЦрлБркм ркЖркиркВркж ркерк╛ркп ркЫрлЗ. ркдрлЗркерлА, ркЕркорлЗ ркЖрккркирк╛ ркУркЯрлЛркорлЗркЯрк┐ркХ ркХрлНрк░рлЗркбрк▓ ркХрк┐ркЯ рк╕рк╛ркерлЗ ркПркХ рк╡рк┐рк╢рлЗрк╖ ркЖрк╢рлНркЪрк░рлНркп ркнрлЗркЯ ркдрк░рлАркХрлЗ ркЙркорлЗрк░рк╡рк╛ ркорк╛ркВркЧрлАркП ркЫрлАркП. ркЖ ркнрлЗркЯ ркЖрккркирлЗ рккрлНрк░рлЗрко ркЕркирлЗ ркЖркиркВркж рк▓рк╛рк╡рк╢рлЗ, ркПрк╡рлА ркЖрк╢рк╛ рк░рк╛ркЦрлАркП ркЫрлАркП!</p>
                <p>ркЖркнрк╛рк░,<br />
                ркмрлЗркмрлА ркХрлЛрк░рлНркктДв<br />
                +рлпрлз-рлпрлнрли-рлирлкрлк-рлзрлжрлйрлж<br />
                +рлпрлз рлпрлнрлн-рлйрлжрлз-рлйрлзрлзрлл</p>
              </>
            )}
            {data.language === "marathi" && (
              <>
                <p>{data.localName},</p>
                <p>Baby Corp рдХреБрдЯреБрдВрдмрд╛рдд рддреБрдордЪрдВ рд╕реНрд╡рд╛рдЧрдд рдЖрд╣реЗ! рдорд╣рд╛рд░рд╛рд╖реНрдЯреН рдЖрдордЪреЗ рдкреНрд░рд┐рдп рдЧреНрд░рд╛рд╣рдХ рдореНрд╣рдгреВрди, рдЖрдореНрд╣реА рддреБрдордЪреНрдпрд╛рд╕реЛрдмрдд рд╣рд╛ рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдХреНрд╖рдг рд╕рд╛рдЬрд░рд╛ рдХрд░рдд рдЖрд╣реЛрдд рдЖрдгрд┐ рддреБрдордЪреНрдпрд╛ Automatic Cradle Kit рд╕реЛрдмрдд рдПрдХ рдЦрд╛рд╕ рд╕рд░рдкреНрд░рд╛рдИрдЬ рдЧрд┐рдлреНрдЯ рджреЗрдд рдЖрд╣реЛрдд. рддреБрдореНрд╣рд╛рд▓рд╛ рддреЗ рдЖрд╡рдбреЗрд▓ рдЕрд╢реА рдЖрдореНрд╣рд╛рд▓рд╛ рдЖрд╢рд╛ рдЖрд╣реЗ!</p>
                <p>рдзреНрдпрд╡рд╛рдж!</p>
                <p>рдЖрдкреБрд▓рдХреАрдиреЗ,<br />
                рдмреЗрдмреА рдХреЙрд░реНрдк (Baby Corp<sup>TM</sup>)<br />
                +91-972-244-1030<br />
                +91 977-301-3115</p>
              </>
            )}
          </div>
        </div>
        <Footer />
      </div>
    </div>
  );

  const renderGenericLetter = () => (
    <div className="p-8 min-h-[297mm] flex flex-col print-page bg-white font-[family-name:var(--font-geist-sans)]">
      <LogoHeader />
      <div className="flex-grow space-y-4">
        <div className="pt-4">
          <p className="mb-4">Dear {data.customerName},</p>
          <p className="font-semibold mb-2">Love What You Bought? ЁЯОБ</p>
          
          <p>If you're delighted with our product, we'd truly appreciate a <span className="font-semibold">5-star rating on Amazon!</span> Your positive feedback helps other customers choose Baby Corp with confidence.</p>
          
          <p>Want to share a greater impact? Leave a <span className="font-semibold">photo or video review</span> to show others the quality firsthand.</p>
          
          <p className="font-semibold mt-4 mb-2">Exclusive Offer ЁЯОЙ</p>
          
          <p>As a thank-you, send us a <span className="font-semibold">screenshot of your 5-star photo/video review</span> along with your invoice on WhatsApp (<span className="font-semibold">+917922441030</span>), and we'll send you <span className="font-semibold">Rs. 50</span> as a token of our appreciation!</p>
          
          <p>Thank you for your support, and we hope to see you again soon!</p>
        </div>
        <div className="pt-8">
          <p className="mb-4"><span className="font-semibold">рдХреНрдпрд╛ рдЖрдкрдХреЛ рд╣рдорд╛рд░рд╛ рдЙрддреНрдкрд╛рдж рдкрд╕рдВрдж рдЖрдпрд╛?</span> рддреЛ рдЖрдкрдХреЗ рдЕрдиреБрднрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд░ рд╣рдореЗрдВ рдЦреБрд╢реА рд╣реЛрдЧреАред рдЕрдЧрд░ рдЖрдкрдХреЛ рдереЛрдбрд╝рд╛ рд╕рдордп рдорд┐рд▓реЗ, рддреЛ рдХреГрдкрдпрд╛ рдЕрдкрдиреЗ рд╡рд┐рдЪрд╛рд░ рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред рдЖрдкрдХреА рд╕рдореАрдХреНрд╖рд╛ рд╣рдореЗрдВ рдЗрд╕ рдЙрддреНрдкрд╛рдж рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдФрд░ рдЕрдиреНрдп рдЦрд░реАрджрд╛рд░реЛрдВ рдХреА рдорджрдж рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░реЗрдЧреАред рдпрджрд┐ рдЖрдк рд╣рдорд╛рд░реЗ рдЙрддреНрдкрд╛рдж рд╕реЗ рдкреНрд░рд╕рдиреНрди рд╣реИрдВ, рддреЛ рдЕрдореЗрдЬрд╝рди рдкрд░ 5-рд╕реНрдЯрд╛рд░ рд░реЗрдЯрд┐рдВрдЧ рджреЗрдХрд░ рд╣рдореЗрдВ рдЦреБрд╢реА рд╣реЛрдЧреА! рдЖрдкрдХреА рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдиреНрдп рдЧреНрд░рд╛я┐╜я┐╜рдХреЛрдВ рдХреЛ рдмреЗрдмреА рдХреЙрд░реНрдк рдкрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗ рд╕рд╛рде рдирд┐рд░реНрдгрдп рд▓реЗрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред</p>
          <p className="mb-4"><span className="font-semibold">рдмрдбрд╝рд╛ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?</span> рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдЧреБрдгрд╡рддреНрддрд╛ рдХрд╛ рдЕрдиреБрднрд╡ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЛрдЯреЛ рдпрд╛ рд╡реАрдбрд┐рдпреЛ рд░рд┐рд╡реНрдпреВ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред</p>
          <p className="mb-4"><span className="font-semibold">рд╡рд┐рд╢реЗрд╖ рдСрдлрд░</span> ЁЯОБ рдЖрдкрдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж рд╕реНрд╡рд░реВрдк, рдЕрдкрдиреА 5-рд╕реНрдЯрд╛рд░ рдлреЛрдЯреЛ/рд╡реАрдбрд┐рдпреЛ рд░рд┐рд╡реНрдпреВ рдХрд╛ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдФрд░ рдЗрдирд╡реЙрдЗрд╕ рд╣рдореЗрдВ рд╡реНрд╣рд╛рдЯреНрд╕рдПрдк рдкрд░ 9722441030 рдкрд░ рднреЗрдЬреЗрдВ, рдФрд░ рд╣рдо рдЖрдкрдХреЛ рдЖрднрд╛рд░ рд╕реНрд╡рд░реВрдк тВ╣50 рднреЗрдЬреЗрдВрдЧреЗ!</p>
          <p>рдЖрдкрдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж!</p>
        </div>
        <div className="pt-4">
          <p>Warm regards,<br />
          Baby Corp<sup>TM</sup><br />
          +91-972-244-1030<br />
          +91 977-301-3115</p>
        </div>
      </div>
      <Footer />
    </div>
  );

  const renderAddressLetter = () => (
    <div className="p-8 min-h-[210mm] w-[297mm] flex flex-col print-page-landscape bg-white font-[family-name:var(--font-geist-sans)]">
      <LogoHeader />
      
      <div className="flex-grow">
        {/* Ship To and Tracking Number */}
        <div className="flex justify-between mb-12">
          <div className="text-xl font-normal">Ship To</div>
          <div className="text-xl font-normal">Tracking Number: {data.trackingId}</div>
        </div>

        {/* Shipping Address */}
        <div className="space-y-2 text-2xl">
          <p className="font-bold">{data.name}</p>
          <p className="font-bold">{data.address?.split(',')[0] || data.address}</p>
          <p className="font-bold">{data.address?.split(',')[1]}</p>
          <p className="font-bold uppercase">{data.address?.split(',')[2]}</p>
          <p className="font-bold">Phone : {data.phone}</p>
        </div>

        {/* Return Address */}
        <div className="mt-auto text-right space-y-1 text-xl">
          <p className="font-bold mb-2">If Undelivered, Please return to</p>
          <p>Baby Corp,</p>
          <p>614, Ganesh Glory, Jagatpur</p>
          <p>Road, Gota,</p>
          <p>Ahmedabad - 382481, Gujarat</p>
          <p>Phone: 9722441030</p>
        </div>
      </div>
    </div>
  );

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent 
        className={cn(
          "max-h-[80vh] overflow-y-auto",
          letterType === "ADDRESS" 
            ? "max-w-[297mm] min-h-[210mm] p-0 address-letter-preview" 
            : "max-w-3xl"
        )}
      >
        <DialogHeader className="dialog-header">
          <DialogTitle>Letter Preview</DialogTitle>
        </DialogHeader>
        
        <div ref={letterRef} className="border rounded-lg shadow-sm">
          {renderLetter()}
        </div>
        
        <div className="dialog-footer flex justify-end gap-4 mt-4">
          <Button variant="outline" onClick={onClose}>
            Close
          </Button>
          <Button onClick={handlePrint}>Print</Button>
          <Button onClick={handleDownloadPDF}>Download PDF</Button>
        </div>
      </DialogContent>
    </Dialog>
  );
} 